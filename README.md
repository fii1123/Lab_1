# Lab_1
Лабораторная работа No 1. Сбор статистики по сетевому трафику

## Описание

Данный набор утилит разработан для анализа входящих пакетов на конкретный сетевой интерфейс.

Набор представляет из себя 2 утилиты:
1. LisIf — собирает пакеты и формирует статистику
2. LisIf_mon — запрашивает у LisIf статистику и выводит её на экран 
    
## Сборка

Для сборки программ вам потребуется пакет GNU GCC и Cmake.
В принципе, все что нужно, это:
1. Скачать средства сборки: `sudo apr-get install gcc cmake`
2. Перейти в директорию с исходниками и запустить скрипт Bilding.sh: `bash Bilding.sh`

В директории rez будут созданы исполняемые файлы.

## Запуск

Для запуска программ необходимы права суперпользователя. Синопсис:

`sudo LisIf [имя сетевого интерфейса (enp0s5 и пр.)] [OPTION]`

Также, утилита использует следующие параметры для фильтрации статистики:

`-sa <source address>`

`-sp <source port>`

`-da <destination address>`

`-dp <destination port>`

Ключи можно распологать в любом порядке

Программа LisIf «ловит» поступающие на сетевой интерфейс пакеты до тех пор, пока не будет запущена программа LisIf_mon или пока число собранных пакетов не будет равно MAX_POCKET_COUNT (65536).
Для получения статистики используется утилита LisIf_mon:

`sudo LisIf_mon`

Утилита получит от LisIf статистику всех пакетов, пришедших на указанный сетевой интерфейс с момента запуска LisIf и до запуска LisIf_mon.

## Результаты профилирования двух реализованных вариантов утилиты для сбора статистики

Утилита LisIf (которая занимается сбором статистики) состоит из двух потоков:
Первый - прослушивает сетевой интерфейс и анализирует пакеты.
Второй - отправляет информацию в LisIf_mon

Для профилирования было разработано 2 варианта утилиты LisIf.

В первом варианте, подсчет статистики (общего размера всех пакетов) производит второй поток (LisIf v1.0-2a).
Во втором, первый (LisIf v1.0-2b).

Чтобы выяснить, какой чариант оптимален, оба потока проверялись импровизируемыми таймерами:

`int start = clock();`
`// some code`
`printf("Timer n: %i", (int)clock() - start);`

Данные, посылаемые утилитой стандартной утилитой netcat:
`asd`
`asd`
`qwe`
`qwe`
`zxc`
`zxc`

Результаты 1 варианта (LisIf v1.0-2a):

`Timer 1: 3`
`Timer 1: 1`
`Timer 1: 2`
`Timer 1: 2`
`Timer 1: 3`
`Timer 1: 2`
`Timer 2: 666`

Результаты 2 варианта (LisIf v1.0-2b)

`Timer 1: 4`
`Timer 1: 1`
`Timer 1: 2`
`Timer 1: 1`
`Timer 1: 2`
`Timer 1: 1`
`Timer 2: 946`



## Авторство и лицензия

Разработчик: Филатов И.А.
e-mail: f2000_99@mail.ru

Лицензия GNU GPL v.3
